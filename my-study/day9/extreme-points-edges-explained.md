# 极端点和极端边详解 - 大白话版

> 本文档详细解释《计算几何及应用》第2.2节"极端点和极端边"的内容，这是理解凸包算法的重要基础。

---

## 目录

1. [为什么要学习极端点和极端边？](#1-为什么要学习极端点和极端边)
2. [极端点的定义](#2-极端点的定义)
3. [极端边的定义](#3-极端边的定义)
4. [图2.1详解](#4-图21详解)
5. [算法2.1：基于极端边的凸包算法](#5-算法21基于极端边的凸包算法)
6. [总结](#6-总结)

---

## 1. 为什么要学习极端点和极端边？

在研究计算凸包的算法之前，我们需要先搞清楚：**算法的输出应该是什么？**

对于一个计算平面点集凸包的算法，其输出是**按边界顺序排列的所有极端点**。

换句话说：
- 凸包的顶点 = 极端点
- 凸包的边 = 极端边
- 算法输出 = 按顺序连接的极端点

```
┌────────────────────────────────────────────────────────────────────────────┐
│                                                                            │
│   凸包算法的输入和输出                                                     │
│                                                                            │
│   输入：一堆散落的点                    输出：按顺序排列的极端点            │
│                                                                            │
│         ●                                    ①                             │
│              ●                              ╱ ╲                            │
│        ●                                   ╱   ╲                           │
│                                           ╱     ╲                          │
│             ● ●                          ②       ╲                         │
│       ●              ●                  ╱          ╲                       │
│                                        ╱            ╲                      │
│            ●                          ③──────────────④                     │
│                 ●                                                          │
│                                        输出：①→②→③→④→①                    │
│                                        （按边界顺序）                       │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
```

---

## 2. 极端点的定义

### 2.1 直观定义

**极端点（Extreme Points）**：平面点集 S 的极端点是指 **S 的凸包上的那些顶点**。

更具体地说：
- S 中 **最上面的点**（y 坐标最大的点）是极端点
- S 中 **最下面的点**（y 坐标最小的点）是极端点
- S 中 **最左边的点**（x 坐标最小的点）是极端点
- S 中 **最右边的点**（x 坐标最大的点）是极端点

**特殊情况**：如果有多个点都是"最上面"的（y 坐标相同且最大），那么其中最左和最右的两个点都是极端点。

```
┌────────────────────────────────────────────────────────────────────────────┐
│                                                                            │
│   极端点示例                                                               │
│                                                                            │
│                    最上面的点 → 极端点                                     │
│                         ↓                                                  │
│                         ●                                                  │
│                        ╱ ╲                                                 │
│   最左边的点 →        ●   ╲                                                │
│   （极端点）         ╱     ╲                                               │
│                     ╱   ●   ╲   ← 内部点，不是极端点                       │
│                    ╱         ╲                                             │
│                   ●     ●     ● ← 最右边的点（极端点）                     │
│                    ╲         ╱                                             │
│                     ╲   ●   ╱   ← 内部点，不是极端点                       │
│                      ╲     ╱                                               │
│                       ╲   ╱                                                │
│                        ╲ ╱                                                 │
│                         ●                                                  │
│                         ↑                                                  │
│                   最下面的点 → 极端点                                      │
│                                                                            │
│   凸包上的顶点都是极端点，内部的点不是极端点                               │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
```

### 2.2 极端点的充分必要条件

**结论**：点集 S 中的点是极端点的**充分必要条件**是：
> 存在一条过这个点的直线与点集 S 的凸包相切。

**大白话解释**：
- 如果你能找到一条直线，这条直线：
  1. 经过点 p
  2. 所有其他点都在这条直线的同一侧（或在直线上）
- 那么点 p 就是极端点！

```
┌────────────────────────────────────────────────────────────────────────────┐
│                                                                            │
│   极端点的切线判定                                                         │
│                                                                            │
│   点 a 是极端点吗？                                                        │
│                                                                            │
│         l₁（切线）                                                         │
│           ╲                                                                │
│            ╲                                                               │
│             ╲                                                              │
│              ╲                                                             │
│               ● a  ← 点 a                                                  │
│              ╱│╲                                                           │
│             ╱ │ ╲                                                          │
│            ╱  │  ╲    所有其他点                                           │
│           ●   │   ●   都在直线 l₁                                          │
│            ╲  │  ╱    的同一侧                                             │
│             ╲ │ ╱                                                          │
│              ╲│╱                                                           │
│               ●                                                            │
│                                                                            │
│   能找到这样的切线 l₁ → 点 a 是极端点 ✓                                    │
│                                                                            │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│   点 p 是极端点吗？（内部点的情况）                                        │
│                                                                            │
│               ●                                                            │
│              ╱ ╲                                                           │
│             ╱   ╲                                                          │
│            ╱  p  ╲   ← 点 p 在内部                                         │
│           ●   ●   ●                                                        │
│            ╲     ╱                                                         │
│             ╲   ╱                                                          │
│              ╲ ╱                                                           │
│               ●                                                            │
│                                                                            │
│   无论怎么画直线，经过 p 的直线两侧都会有点                                │
│   找不到这样的切线 → 点 p 不是极端点 ✗                                     │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
```

### 2.3 切线条件的局限性

书中指出：**尽管该条件很容易理解，但却很难根据它来计算一个点是否为极端点。**

为什么难？因为要验证"所有其他点都在直线同一侧"，需要检查所有点，而且切线的方向有无数种可能。

所以我们需要另一个概念——**极端边**。

---

## 3. 极端边的定义

### 3.1 定义

**极端边（Extreme Edges）**：一条边（点集 S 中两点的连线）被称为极端边，当且仅当：
> 点集 S 中的所有点都在这条边所在直线的**同一侧**或**恰好落在这条直线上**。

```
┌────────────────────────────────────────────────────────────────────────────┐
│                                                                            │
│   极端边的定义                                                             │
│                                                                            │
│   边 ab 是极端边吗？                                                       │
│                                                                            │
│                    l₂（边 ab 所在的直线）                                  │
│   ─────────────────●─────────────●──────────────────────                   │
│                    a             b                                         │
│                                                                            │
│                    ●   ●                                                   │
│                  ●       ●                                                 │
│                    ●   ●                                                   │
│                      ●                                                     │
│                                                                            │
│   所有其他点都在直线 l₂ 的下方（同一侧）                                   │
│   → 边 ab 是极端边 ✓                                                       │
│                                                                            │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│   边 cd 是极端边吗？                                                       │
│                                                                            │
│                    ●                                                       │
│                  ╱   ╲                                                     │
│       ●        ╱       ╲                                                   │
│         ╲    c●─────────●d                                                 │
│           ╲  ╱           ╲                                                 │
│            ●╱             ╲●                                               │
│                                                                            │
│   直线 cd 的上方有点，下方也有点                                           │
│   → 边 cd 不是极端边 ✗                                                     │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
```

### 3.2 极端边与凸包的关系

**核心结论**：
- **极端边 = 凸包的边**
- 排除掉点集 S 中所有的非极端边，最后剩下的边就是点集 S 的凸包上的边！

```
┌────────────────────────────────────────────────────────────────────────────┐
│                                                                            │
│   极端边筛选过程                                                           │
│                                                                            │
│   原始点集                       检查每条边                                │
│                                                                            │
│         ●a                        边 ab：检查...是极端边 ✓                 │
│        ╱  ╲                       边 ac：检查...不是极端边 ✗               │
│       ╱ ●e ╲                      边 ad：检查...不是极端边 ✗               │
│      ●b     ●c                    边 ae：检查...不是极端边 ✗               │
│       ╲    ╱                      边 bc：检查...是极端边 ✓                 │
│        ╲  ╱                       边 bd：检查...不是极端边 ✗               │
│         ●d                        ...                                      │
│                                                                            │
│                                  最终：极端边 = {ab, bc, cd, da}           │
│                                  这就是凸包的四条边！                      │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
```

### 3.3 如何判断点在边的哪一侧？

为了判断一个点是否在边所在直线的同一侧，我们需要规定**有向边的方向**：
- 把边看作有方向的（从起点到终点）
- **左侧**：定义为凸包的**内侧**
- **右侧**：定义为凸包的**外侧**

**判定规则**：
- 如果一条边（点集 S 中两点的连线）的**右侧**存在某些点落在其右侧
- 那么这条边**不是极端边**

```
┌────────────────────────────────────────────────────────────────────────────┐
│                                                                            │
│   有向边的左右侧判定                                                       │
│                                                                            │
│   有向边 pᵢpⱼ（从 pᵢ 指向 pⱼ）                                            │
│                                                                            │
│             左侧                                                           │
│           （内侧）                                                         │
│              ↑                                                             │
│              │                                                             │
│        pᵢ ●──────────→ ● pⱼ                                               │
│              │                                                             │
│              ↓                                                             │
│             右侧                                                           │
│           （外侧）                                                         │
│                                                                            │
│   规定：沿着边的方向走，左手边是内侧，右手边是外侧                         │
│                                                                            │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│   判定示例                                                                 │
│                                                                            │
│   边 pᵢpⱼ 是极端边吗？                                                     │
│                                                                            │
│              ●                                                             │
│             ╱                                                              │
│        pᵢ ●──────────→ ● pⱼ                                               │
│           │╲            ╱                                                  │
│           │ ●         ●                                                    │
│           │  ╲      ╱                                                      │
│           │   ● ─ ●                                                        │
│           ↓                                                                │
│          右侧有点！                                                        │
│                                                                            │
│   右侧有点存在 → 边 pᵢpⱼ 不是极端边 ✗                                      │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
```

---

## 4. 图2.1详解

书中的图2.1展示了极端点和极端边的例子：

```
┌────────────────────────────────────────────────────────────────────────────┐
│                                                                            │
│   图 2.1：点集 S 的一个极端点和一条极端边                                  │
│                                                                            │
│                                                                            │
│                  l₂        l₁                                              │
│                   │         │                                              │
│                   │    ●    │                                              │
│                   │   ╱ ╲   │                                              │
│            ●─────●b─╱───╲──│                                               │
│           ╱      │ ╱     ╲ │                                               │
│          ╱   ●   │╱   ●   ╲│                                               │
│         ╱      ●●╱●        ●a ← 极端点                                     │
│        ╱       ╱●│   ●     │╲                                              │
│       ╱    ● ╱ ● │         │ ╲                                             │
│      ╱    ●╱     │    ●    │  ╲                                            │
│     ╱    ╱●      │         │   ╲                                           │
│    ●───╱─────────│─────────│                                               │
│                  │         │                                               │
│                                                                            │
│   解释：                                                                   │
│                                                                            │
│   • 点 a 是极端点：                                                        │
│     - 直线 l₁ 经过点 a                                                     │
│     - 所有其他点都在 l₁ 的左侧                                             │
│     - l₁ 与凸包相切于点 a                                                  │
│                                                                            │
│   • 边 ab 是极端边：                                                       │
│     - 直线 l₂ 经过点 a 和点 b                                              │
│     - 所有其他点都在 l₂ 的同一侧（下方）                                   │
│     - 边 ab 是凸包的一条边                                                 │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
```

---

## 5. 算法2.1：基于极端边的凸包算法

### 5.1 算法描述

书中给出了一个基于极端边的凸包算法：

**算法 2.1 Extreme Edges(S)** —— 基于极端边计算点集凸包的算法

```
输入：二维点集 S
输出：点集 S 凸包上的所有边

1) for 点集中每个顶点 pᵢ
2)     for 点集中每个不同于顶点 pᵢ 的顶点 pⱼ
3)         for 点集中每个不同于 pᵢ 和 pⱼ 的顶点 pₖ
4)             if (pₖ 不在有向边 pᵢpⱼ 的左边)
5)                 标记边 pᵢpⱼ 为被删除边；// pᵢpⱼ 不是极端边
6) 输出未被作删除标记的所有边。结束。
```

### 5.2 大白话解释

```
┌────────────────────────────────────────────────────────────────────────────┐
│                                                                            │
│   算法思路：排除法                                                         │
│                                                                            │
│   基本想法：                                                               │
│   1. 枚举所有可能的边（任意两点的连线）                                    │
│   2. 对于每条边，检查是否存在某个点在它的"外侧"（右侧）                     │
│   3. 如果存在，这条边不是极端边，删掉它                                    │
│   4. 最后剩下的就是极端边（凸包的边）                                      │
│                                                                            │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│   第一层循环：选择边的起点 pᵢ                                              │
│   第二层循环：选择边的终点 pⱼ                                              │
│   第三层循环：检查其他所有点 pₖ                                            │
│                                                                            │
│   关键判断：pₖ 是否在有向边 pᵢpⱼ 的左边？                                  │
│                                                                            │
│   • 如果 pₖ 不在左边（在右边或在直线上）→ 边 pᵢpⱼ 可能不是极端边           │
│   • 只要有一个点 pₖ 在右边 → 边 pᵢpⱼ 一定不是极端边                        │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
```

### 5.3 算法示例

```
┌────────────────────────────────────────────────────────────────────────────┐
│                                                                            │
│   示例：4个点 {A, B, C, D}                                                 │
│                                                                            │
│              A●                                                            │
│              ╱╲                                                            │
│             ╱  ╲                                                           │
│            ╱    ╲                                                          │
│           ╱  D●  ╲                                                         │
│          ╱        ╲                                                        │
│        B●──────────●C                                                      │
│                                                                            │
│   检查所有边：                                                             │
│                                                                            │
│   边 AB：检查 C 和 D                                                       │
│         C 在 AB 的右边 → AB 不是极端边 ✗                                   │
│                                                                            │
│   边 BA：检查 C 和 D                                                       │
│         C 在 BA 的左边，D 在 BA 的左边 → BA 可能是极端边                   │
│         （继续检查...）最终 BA 是极端边 ✓                                  │
│                                                                            │
│   边 AC：检查 B 和 D                                                       │
│         D 在 AC 的左边，B 在 AC 的... → 继续分析                           │
│                                                                            │
│   ...（检查所有 12 条有向边）                                              │
│                                                                            │
│   最终结果：极端边 = {BA, AC, CB}（或等价的 {AB, BC, CA}）                 │
│   这就是三角形 ABC 的三条边！                                              │
│   点 D 在三角形内部，不是极端点。                                          │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
```

### 5.4 如何判断点在有向边的左边还是右边？

这是一个重要的计算几何基础问题。使用**叉积**来判断：

```
┌────────────────────────────────────────────────────────────────────────────┐
│                                                                            │
│   叉积判断左右侧                                                           │
│                                                                            │
│   有向边：从 pᵢ 到 pⱼ                                                      │
│   待判断点：pₖ                                                             │
│                                                                            │
│   计算向量：                                                               │
│   • 向量 v1 = pⱼ - pᵢ = (pⱼ.x - pᵢ.x, pⱼ.y - pᵢ.y)                        │
│   • 向量 v2 = pₖ - pᵢ = (pₖ.x - pᵢ.x, pₖ.y - pᵢ.y)                        │
│                                                                            │
│   叉积：                                                                   │
│   cross = v1.x × v2.y - v1.y × v2.x                                        │
│         = (pⱼ.x - pᵢ.x)(pₖ.y - pᵢ.y) - (pⱼ.y - pᵢ.y)(pₖ.x - pᵢ.x)        │
│                                                                            │
│   判断规则：                                                               │
│   • cross > 0  →  pₖ 在有向边 pᵢpⱼ 的左边                                  │
│   • cross < 0  →  pₖ 在有向边 pᵢpⱼ 的右边                                  │
│   • cross = 0  →  pₖ 在直线 pᵢpⱼ 上（共线）                                │
│                                                                            │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│   图示：                                                                   │
│                                                                            │
│                    pₖ                                                      │
│                    ●   cross > 0（左边）                                   │
│                   ╱                                                        │
│                  ╱                                                         │
│            pᵢ ●────────────→ ● pⱼ                                         │
│                  ╲                                                         │
│                   ╲                                                        │
│                    ●   cross < 0（右边）                                   │
│                    pₘ                                                      │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
```

### 5.5 时间复杂度分析

**算法 2.1 的时间复杂度：O(n³)**

```
┌────────────────────────────────────────────────────────────────────────────┐
│                                                                            │
│   复杂度分析                                                               │
│                                                                            │
│   三层循环嵌套：                                                           │
│   • 第一层：遍历 n 个点选择 pᵢ          → O(n)                             │
│   • 第二层：遍历 n-1 个点选择 pⱼ        → O(n)                             │
│   • 第三层：遍历 n-2 个点选择 pₖ        → O(n)                             │
│                                                                            │
│   总复杂度：O(n) × O(n) × O(n) = O(n³)                                     │
│                                                                            │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│   这个复杂度好不好？                                                       │
│                                                                            │
│   不好！O(n³) 太慢了！                                                     │
│                                                                            │
│   • n = 100 时，需要约 100万 次操作                                        │
│   • n = 1000 时，需要约 10亿 次操作                                        │
│   • n = 10000 时，需要约 1万亿 次操作                                      │
│                                                                            │
│   实际应用中无法满足需求。                                                 │
│                                                                            │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│   另一个缺点：                                                             │
│                                                                            │
│   算法只输出了凸包的边，但没有给出**顺序**！                               │
│   实际上我们需要按边界顺序排列的极端点。                                   │
│                                                                            │
│   所以后面会介绍更高效的算法（如 Graham Scan、Jarvis March 等）            │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
```

### 5.6 Python 伪代码实现

```python
def extreme_edges(S):
    """
    基于极端边的凸包算法
    输入：点集 S（列表，每个元素是 (x, y) 坐标）
    输出：凸包的边（极端边列表）
    时间复杂度：O(n³)
    """
    n = len(S)
    is_extreme = [[True] * n for _ in range(n)]  # is_extreme[i][j] 表示边 ij 是否是极端边

    # 三层循环
    for i in range(n):
        for j in range(n):
            if i == j:
                continue
            for k in range(n):
                if k == i or k == j:
                    continue
                # 判断 pk 是否在有向边 pi->pj 的左边
                if not is_left(S[i], S[j], S[k]):
                    is_extreme[i][j] = False  # pk 不在左边，说明 ij 不是极端边
                    break  # 可以提前退出第三层循环

    # 收集所有极端边
    extreme_edge_list = []
    for i in range(n):
        for j in range(n):
            if i != j and is_extreme[i][j]:
                extreme_edge_list.append((S[i], S[j]))

    return extreme_edge_list


def is_left(pi, pj, pk):
    """
    判断点 pk 是否在有向边 pi->pj 的左边（或在直线上）
    使用叉积判断
    """
    # 向量 pi->pj
    v1 = (pj[0] - pi[0], pj[1] - pi[1])
    # 向量 pi->pk
    v2 = (pk[0] - pi[0], pk[1] - pi[1])
    # 叉积
    cross = v1[0] * v2[1] - v1[1] * v2[0]
    # cross > 0 表示 pk 在左边
    # cross = 0 表示共线（也算"不在右边"）
    # cross < 0 表示 pk 在右边
    return cross >= 0  # 左边或共线
```

---

## 6. 总结

### 6.1 核心概念速查表

```
┌────────────────────────────────────────────────────────────────────────────┐
│                                                                            │
│   【极端点和极端边 核心要点】                                              │
│                                                                            │
│   ┌─────────────────┬──────────────────────────────────────────────────┐  │
│   │     概念        │                   要点                           │  │
│   ├─────────────────┼──────────────────────────────────────────────────┤  │
│   │  极端点         │  凸包的顶点                                      │  │
│   │  (Extreme Point)│  存在过该点的直线与凸包相切                      │  │
│   ├─────────────────┼──────────────────────────────────────────────────┤  │
│   │  极端边         │  凸包的边                                        │  │
│   │  (Extreme Edge) │  所有其他点都在该边所在直线的同一侧              │  │
│   ├─────────────────┼──────────────────────────────────────────────────┤  │
│   │  左右侧判断     │  使用叉积：cross > 0 在左边，< 0 在右边          │  │
│   ├─────────────────┼──────────────────────────────────────────────────┤  │
│   │  算法2.1        │  三层循环枚举，排除非极端边                      │  │
│   │                 │  时间复杂度 O(n³)，效率不高                      │  │
│   └─────────────────┴──────────────────────────────────────────────────┘  │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
```

### 6.2 算法对比

| 算法 | 时间复杂度 | 优点 | 缺点 |
|------|------------|------|------|
| 算法2.1（极端边） | O(n³) | 思路简单直观 | 太慢，不实用 |
| Graham Scan | O(n log n) | 高效 | 需要排序 |
| Jarvis March | O(nh) | 输出敏感 | h大时较慢 |
| 分治法 | O(n log n) | 高效 | 实现较复杂 |

其中 h 是凸包的顶点数。

### 6.3 下一步学习

学完极端点和极端边后，下一步可以学习：
1. **Graham Scan 算法**：更高效的凸包算法
2. **Jarvis March（Gift Wrapping）算法**：另一种经典算法
3. **凸包的下界证明**：证明 O(n log n) 是最优的

---

*文档创建日期：2026年1月4日*
*参考书籍：《计算几何及应用》第2.2节*
