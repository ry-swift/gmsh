# IGES 文件解析与 IGESCAFControl_Reader 读取过程深度解析

## 概述

本文档详细解析 `hhh.igs` 文件的内容，以及 `IGESCAFControl_Reader` 如何读取并转换它。

---

## 一、IGES 文件基本结构

IGES 文件是**固定列宽的 ASCII 文本文件**，每行 80 个字符，分为 5 个段：

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        IGES 文件五大段结构                                   │
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │  列位置:  1-72 (数据区)  │  73 (段标识符)  │  74-80 (行号)           │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │  S 段 - Start Section (开始段)                                      │   │
│   │  - 人类可读的注释和描述                                              │   │
│   │  - 段标识符: S                                                       │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
│                              │                                              │
│                              ▼                                              │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │  G 段 - Global Section (全局段)                                     │   │
│   │  - 文件级参数: 单位、精度、作者、日期等                              │   │
│   │  - 段标识符: G                                                       │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
│                              │                                              │
│                              ▼                                              │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │  D 段 - Directory Entry Section (目录段)                            │   │
│   │  - 每个实体的元数据 (类型、颜色、图层、变换矩阵指针等)               │   │
│   │  - 每个实体占用 2 行 (每行80字符,共160字符)                          │   │
│   │  - 段标识符: D                                                       │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
│                              │                                              │
│                              ▼                                              │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │  P 段 - Parameter Data Section (参数段)                             │   │
│   │  - 每个实体的具体几何参数值                                          │   │
│   │  - 段标识符: P                                                       │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
│                              │                                              │
│                              ▼                                              │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │  T 段 - Terminate Section (结束段)                                  │   │
│   │  - 记录各段的行数统计                                                │   │
│   │  - 段标识符: T                                                       │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 二、hhh.igs 文件详细解析

### 2.1 S 段 (Start Section) - 第 1 行

```
3D InterOp IGES (v. 2021 1.0.0), Spatial Corp. Copyright (c) 1999-2020. S      1
                                                                        ^      ^
                                                                        │      │
                                                                段标识符 S    行号 1
```

**含义**: 这是由 Spatial Corp 的 3D InterOp 软件生成的 IGES 文件。

---

### 2.2 G 段 (Global Section) - 第 2-4 行

```
1H,,1H;,6HNoname,7Hhhh.igs,13HSpatial Corp.,20H3D InterOp ACIS/IGES,32, G      1
38, 6,308,15,6HNoname,1.000,2,2HMM,1,1.000,15H20251222.182956,1.0e-06,  G      2
0.00,6HNoname,6HNoname,11,0,15H20251222.182956;                         G      3
```

**参数解析**:

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                          G 段参数详解                                        │
│                                                                             │
│   参数格式: nH表示后面跟n个字符的字符串                                       │
│                                                                             │
│   ┌───────────────────────────────────────────────────────────────────────┐ │
│   │  参数位置  │  值                │  含义                               │ │
│   ├───────────┼────────────────────┼─────────────────────────────────────┤ │
│   │     1     │  1H,               │  参数分隔符: ","                    │ │
│   │     2     │  1H;               │  记录分隔符: ";"                    │ │
│   │     3     │  6HNoname          │  发送系统产品ID: "Noname"           │ │
│   │     4     │  7Hhhh.igs         │  文件名: "hhh.igs"                  │ │
│   │     5     │  13HSpatial Corp.  │  发送系统ID: "Spatial Corp."        │ │
│   │     6     │  20H3D InterOp...  │  预处理器版本                       │ │
│   │     7     │  32                │  发送系统整数位数                   │ │
│   │     8     │  38                │  发送系统单精度位数                 │ │
│   │     9     │  6                 │  发送系统单精度指数位数             │ │
│   │    10     │  308               │  发送系统双精度位数                 │ │
│   │    11     │  15                │  发送系统双精度指数位数             │ │
│   │    12     │  6HNoname          │  接收系统产品ID                     │ │
│   │    13     │  1.000             │  模型空间比例                       │ │
│   │    14     │  2                 │  单位标志: 2=MM (毫米)              │ │
│   │    15     │  2HMM              │  单位名称: "MM"                     │ │
│   │    16     │  1                 │  线宽最大等级数                     │ │
│   │    17     │  1.000             │  最大线宽(单位)                     │ │
│   │    18     │  15H20251222...    │  文件生成时间戳                     │ │
│   │    19     │  1.0e-06           │  最小用户分辨率                     │ │
│   │    20     │  0.00              │  模型最大坐标值                     │ │
│   │    21     │  6HNoname          │  作者名                             │ │
│   │    22     │  6HNoname          │  作者组织                           │ │
│   │    23     │  11                │  IGES版本号 (11=5.3)                │ │
│   │    24     │  0                 │  绘图标准: 0=无                     │ │
│   │    25     │  15H20251222...    │  模型创建/修改时间                  │ │
│   └───────────┴────────────────────┴─────────────────────────────────────┘ │
│                                                                             │
│   关键信息:                                                                  │
│   • 单位: MM (毫米)                                                         │
│   • 精度: 1.0e-06                                                           │
│   • 文件生成时间: 2025年12月22日 18:29:56                                    │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

### 2.3 D 段 (Directory Entry Section) - 第 5-224 行

每个实体占 2 行，共 160 个字符。以第一个实体为例：

```
     110       1       0       0       0       0       0       000010001D      1
     110       0       0       1       0       0       0               0D      2
```

**D 段字段解析**:

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        D 段每行字段含义 (共20个字段)                         │
│                                                                             │
│   第一行 (奇数行):                                                           │
│   ┌────────┬────────┬────────┬────────┬────────┬────────┬────────┬────────┐ │
│   │ 字段1  │ 字段2  │ 字段3  │ 字段4  │ 字段5  │ 字段6  │ 字段7  │ 字段8  │ │
│   │ 1-8    │ 9-16   │17-24   │25-32   │33-40   │41-48   │49-56   │57-64   │ │
│   ├────────┼────────┼────────┼────────┼────────┼────────┼────────┼────────┤ │
│   │实体类型│参数数据│结构    │线型    │层级    │视图    │变换矩阵│标签显示│ │
│   │ 110    │ 行号1  │        │        │        │        │ 指针   │ 关联   │ │
│   └────────┴────────┴────────┴────────┴────────┴────────┴────────┴────────┘ │
│                                                                             │
│   ┌────────┬────────────────────────────────────────────────────────────────┐│
│   │ 字段9  │ 字段10 (状态标志)                                              ││
│   │ 65-72  │ 73-80                                                          ││
│   ├────────┼────────────────────────────────────────────────────────────────┤│
│   │状态号  │ 8位数字: 空白/从属/物理/拓扑/...                               ││
│   │000010001│                                                               ││
│   └────────┴────────────────────────────────────────────────────────────────┘│
│                                                                             │
│   第二行 (偶数行):                                                           │
│   ┌────────┬────────┬────────┬────────┬────────┬────────┬────────┬────────┐ │
│   │ 字段11 │ 字段12 │ 字段13 │ 字段14 │ 字段15 │ 字段16 │ 字段17 │ 字段18 │ │
│   │ 1-8    │ 9-16   │17-24   │25-32   │33-40   │41-48   │49-56   │57-64   │ │
│   ├────────┼────────┼────────┼────────┼────────┼────────┼────────┼────────┤ │
│   │实体类型│线宽    │颜色    │参数行数│表单号  │保留    │保留    │实体标签│ │
│   │ (重复) │        │        │        │        │        │        │        │ │
│   └────────┴────────┴────────┴────────┴────────┴────────┴────────┴────────┘ │
│                                                                             │
│   ┌────────┬────────────────────────────────────────────────────────────────┐│
│   │ 字段19 │ 字段20 (目录行序号)                                            ││
│   │ 65-72  │ 73-80                                                          ││
│   ├────────┼────────────────────────────────────────────────────────────────┤│
│   │实体下标│ D段行号                                                        ││
│   └────────┴────────────────────────────────────────────────────────────────┘│
└─────────────────────────────────────────────────────────────────────────────┘
```

**hhh.igs 中的主要实体类型**:

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                      hhh.igs 中的 IGES 实体类型                              │
│                                                                             │
│   ┌─────────┬───────────────────────────────────┬─────────────────────────┐ │
│   │ 类型号  │ 名称                               │ 说明                    │ │
│   ├─────────┼───────────────────────────────────┼─────────────────────────┤ │
│   │   100   │ Circular Arc (圆弧)                │ 定义在 XY 平面上的圆弧  │ │
│   │   110   │ Line (直线)                        │ 3D 空间中的直线段       │ │
│   │   116   │ Point (点)                         │ 3D 空间中的点           │ │
│   │   120   │ Surface of Revolution (旋转曲面)  │ 绕轴旋转生成的曲面      │ │
│   │   123   │ Direction (方向)                   │ 单位方向向量            │ │
│   │   124   │ Transformation Matrix (变换矩阵)  │ 坐标变换矩阵            │ │
│   │   186   │ Manifold Solid B-Rep (实体)       │ B-Rep 表示的实体        │ │
│   │   190   │ Plane Surface (平面)              │ 无限平面                │ │
│   │   194   │ Cylindrical Surface (圆柱面)      │ 圆柱面                  │ │
│   │   502   │ Vertex List (顶点列表)            │ 边界顶点集合            │ │
│   │   504   │ Edge List (边列表)                │ 边界边集合              │ │
│   │   508   │ Loop (环)                          │ 面的边界环              │ │
│   │   510   │ Face (面)                          │ B-Rep 面                │ │
│   │   514   │ Shell (壳)                         │ 面的集合                │ │
│   └─────────┴───────────────────────────────────┴─────────────────────────┘ │
│                                                                             │
│   该文件描述的是: 包含 3 个实体(Solid)的 B-Rep 模型                         │
│   - 实体186 出现在 D39-40, D115-116, D219-220 → 3 个 Manifold Solid B-Rep   │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

### 2.4 P 段 (Parameter Data Section) - 第 225-347 行

以几个关键实体为例：

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        P 段参数数据示例                                      │
│                                                                             │
│   Line (Type 110) - 直线:                                                    │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │  110,0.,0.,0.,0.,0.,1000.;                           1P      1      │   │
│   │      ↑  ↑  ↑  ↑  ↑  ↑                                               │   │
│   │      X1 Y1 Z1 X2 Y2 Z2                                              │   │
│   │                                                                     │   │
│   │  含义: 从点(0,0,0)到点(0,0,1000)的直线                              │   │
│   │        即沿Z轴的长度为1000mm的线段                                  │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│   Circular Arc (Type 100) - 圆弧:                                           │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │  100,0.,0.,0.,1000.,0.,-1000.,0.00000000000012;      5P      3      │   │
│   │      ↑  ↑  ↑  ↑    ↑  ↑     ↑                                       │   │
│   │      Zt Xc Yc X1   Y1 X2    Y2                                      │   │
│   │                                                                     │   │
│   │  含义: Z位移=0, 圆心(0,0), 起点(1000,0), 终点(-1000,~0)             │   │
│   │        这是一个半径1000mm的半圆                                     │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│   Transformation Matrix (Type 124) - 变换矩阵:                              │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │  124,0.,1.,0.,0.,0.,0.,1.,0.,1.,0.,0.,0.;            3P      2      │   │
│   │      R11 R12 R13 T1 R21 R22 R23 T2 R31 R32 R33 T3                   │   │
│   │                                                                     │   │
│   │  含义: 3x3旋转矩阵 + 3x1平移向量                                    │   │
│   │  ┌           ┐   ┌   ┐                                              │   │
│   │  │ 0  1  0   │   │ 0 │                                              │   │
│   │  │ 0  0  1   │ + │ 0 │  这是一个绕X轴旋转90°的变换                  │   │
│   │  │ 1  0  0   │   │ 0 │                                              │   │
│   │  └           ┘   └   ┘                                              │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│   Surface of Revolution (Type 120) - 旋转曲面:                              │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │  120,1,5,0.,6.28318530717959;                        7P      4      │   │
│   │      ↑ ↑ ↑  ↑                                                       │   │
│   │      轴 曲线 起始角 终止角                                           │   │
│   │                                                                     │   │
│   │  含义: 用实体1(直线)作为轴,实体5(圆弧)绕其旋转                       │   │
│   │        从0到2π (完整旋转一周)                                       │   │
│   │        生成一个圆柱面或圆环面                                        │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│   Manifold Solid B-Rep (Type 186) - 实体:                                   │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │  186,37,1,0;                                         39P     20     │   │
│   │      ↑  ↑ ↑                                                         │   │
│   │      壳指针 壳朝向标志 空隙壳数量                                    │   │
│   │                                                                     │   │
│   │  含义: 指向 D37-38 的 Shell (Type 514)                              │   │
│   │        朝向=1 (外向), 无空隙壳                                      │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

### 2.5 T 段 (Terminate Section) - 第 348 行

```
S      1G      3D    220P    123                                        T      1
↑      ↑↑      ↑↑    ↑↑↑    ↑↑↑
│      ││      ││    ││     │
S段1行  G段3行  D段220行 P段123行
```

---

## 三、IGESCAFControl_Reader 读取过程

```
┌─────────────────────────────────────────────────────────────────────────────┐
│              IGESCAFControl_Reader 读取 hhh.igs 的完整流程                   │
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │  第1步: 创建读取器并读取文件                                         │   │
│   │                                                                     │   │
│   │  IGESCAFControl_Reader reader;                                      │   │
│   │  IFSelect_ReturnStatus status = reader.ReadFile("hhh.igs");         │   │
│   │                                                                     │   │
│   │  内部操作:                                                          │   │
│   │  ┌─────────────────────────────────────────────────────────────┐   │   │
│   │  │  1. 打开文件,验证是否为IGES格式                             │   │   │
│   │  │  2. 逐行解析,识别段标识符 (S/G/D/P/T)                       │   │   │
│   │  │  3. 解析 G 段,提取全局参数 (单位=MM, 精度=1e-6)             │   │   │
│   │  │  4. 解析 D 段,构建实体目录 (110个实体,220行)                │   │   │
│   │  │  5. 解析 P 段,读取每个实体的参数数据                        │   │   │
│   │  │  6. 构建 IGESData_IGESModel 内存模型                        │   │   │
│   │  └─────────────────────────────────────────────────────────────┘   │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
│                                      │                                      │
│                                      ▼                                      │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │  第2步: 获取根实体数量                                              │   │
│   │                                                                     │   │
│   │  Standard_Integer nRoots = reader.NbRootsForTransfer();             │   │
│   │                                                                     │   │
│   │  内部操作:                                                          │   │
│   │  ┌─────────────────────────────────────────────────────────────┐   │   │
│   │  │  遍历所有实体,找出"根实体" (不被其他实体引用的顶层实体)      │   │   │
│   │  │  对于 hhh.igs:                                               │   │   │
│   │  │  - Type 186 (Manifold Solid B-Rep) 是根实体                 │   │   │
│   │  │  - 共找到 3 个根实体 (3个实体)                               │   │   │
│   │  └─────────────────────────────────────────────────────────────┘   │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
│                                      │                                      │
│                                      ▼                                      │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │  第3步: 转换所有根实体                                              │   │
│   │                                                                     │   │
│   │  reader.TransferRoots();                                            │   │
│   │                                                                     │   │
│   │  内部操作 (对每个 Type 186 实体):                                   │   │
│   │  ┌─────────────────────────────────────────────────────────────┐   │   │
│   │  │  1. 解析 Shell (Type 514) → 获取面列表                      │   │   │
│   │  │  2. 解析每个 Face (Type 510) → 获取几何面和边界环           │   │   │
│   │  │  3. 解析 Loop (Type 508) → 获取边界边                       │   │   │
│   │  │  4. 解析 Edge List (Type 504) → 获取边的几何                │   │   │
│   │  │  5. 解析 Vertex List (Type 502) → 获取顶点坐标              │   │   │
│   │  │  6. 解析基础几何:                                           │   │   │
│   │  │     - Type 110 (Line) → 创建 Geom_Line                      │   │   │
│   │  │     - Type 100 (Arc) → 创建 Geom_Circle                     │   │   │
│   │  │     - Type 120 (Revolution) → 创建旋转曲面                  │   │   │
│   │  │     - Type 190/194 (Plane/Cylinder) → 创建曲面              │   │   │
│   │  │  7. 应用 Type 124 变换矩阵到几何对象                        │   │   │
│   │  │  8. 构建 BRep 拓扑:                                         │   │   │
│   │  │     TopoDS_Vertex → TopoDS_Edge → TopoDS_Wire →             │   │   │
│   │  │     TopoDS_Face → TopoDS_Shell → TopoDS_Solid               │   │   │
│   │  └─────────────────────────────────────────────────────────────┘   │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
│                                      │                                      │
│                                      ▼                                      │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │  第4步: 获取结果形状                                                │   │
│   │                                                                     │   │
│   │  TopoDS_Shape result = reader.OneShape();                           │   │
│   │                                                                     │   │
│   │  结果:                                                              │   │
│   │  ┌─────────────────────────────────────────────────────────────┐   │   │
│   │  │  返回一个 TopoDS_Compound,包含 3 个 TopoDS_Solid            │   │   │
│   │  │                                                             │   │   │
│   │  │     Compound                                                │   │   │
│   │  │        │                                                    │   │   │
│   │  │        ├── Solid 1 (圆柱体)                                 │   │   │
│   │  │        ├── Solid 2 (某个形状)                               │   │   │
│   │  │        └── Solid 3 (某个形状)                               │   │   │
│   │  └─────────────────────────────────────────────────────────────┘   │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 四、hhh.igs 几何内容分析

根据参数数据分析，该文件包含:

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                      hhh.igs 几何模型内容                                    │
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │  实体 1 (D39-40 → P20):                                             │   │
│   │                                                                     │   │
│   │  • Type 186 (Manifold Solid B-Rep)                                  │   │
│   │  • 包含旋转曲面 (Type 120)                                          │   │
│   │  • 基础曲线: 半径1000mm的圆弧绕Z轴旋转                              │   │
│   │  • 可能是一个圆柱体或圆环                                           │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │  实体 2 (D115-116 → P62):                                           │   │
│   │                                                                     │   │
│   │  • Type 186 (Manifold Solid B-Rep)                                  │   │
│   │  • 包含平面 (Type 190) 和圆柱面 (Type 194)                          │   │
│   │  • 顶点位置包括 (0,0,5000), (0,0,2000) 等                           │   │
│   │  • 可能是一个带孔的棱柱体                                           │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │  实体 3 (D219-220 → P123):                                          │   │
│   │                                                                     │   │
│   │  • Type 186 (Manifold Solid B-Rep)                                  │   │
│   │  • 更复杂的几何,包含多条直线边                                       │   │
│   │  • 顶点包括 (2500,500,5000), (4000,1000,0) 等                       │   │
│   │  • 可能是一个多面体                                                 │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│   模型尺度:                                                                  │
│   • 单位: 毫米 (MM)                                                         │
│   • Z 方向范围: 0 ~ 5000 mm                                                 │
│   • XY 方向范围: -1000 ~ 4000 mm                                            │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 五、Gmsh 中的完整调用链

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                    Gmsh 读取 hhh.igs 的完整调用链                            │
│                                                                             │
│   gmsh tutorials/hhh.igs                                                    │
│           │                                                                 │
│           ▼                                                                 │
│   OpenProject("tutorials/hhh.igs")                                          │
│           │                                                                 │
│           ▼                                                                 │
│   MergeFile("tutorials/hhh.igs")                                            │
│           │                                                                 │
│           ▼                                                                 │
│   ext == ".igs" → GModel::readOCCIGES()                                     │
│           │                                                                 │
│           ▼                                                                 │
│   OCC_Internals::importShapes("hhh.igs", ...)                               │
│           │                                                                 │
│           ├──► setTargetUnit("MM")  // 设置单位                             │
│           │                                                                 │
│           ├──► IGESCAFControl_Reader reader;                                │
│           │    reader.ReadFile("hhh.igs");                                  │
│           │           │                                                     │
│           │           ▼                                                     │
│           │    ┌─────────────────────────────────────────────────────────┐ │
│           │    │  解析 S 段 → 获取文件信息                               │ │
│           │    │  解析 G 段 → 获取单位=MM, 精度=1e-6                     │ │
│           │    │  解析 D 段 → 构建 110 个实体的目录                      │ │
│           │    │  解析 P 段 → 读取每个实体的几何参数                     │ │
│           │    │  构建 IGESData_IGESModel                                │ │
│           │    └─────────────────────────────────────────────────────────┘ │
│           │                                                                 │
│           ├──► reader.NbRootsForTransfer();  // 返回 3                      │
│           │                                                                 │
│           ├──► reader.TransferRoots();                                      │
│           │           │                                                     │
│           │           ▼                                                     │
│           │    ┌─────────────────────────────────────────────────────────┐ │
│           │    │  转换 3 个 Type 186 (Solid) 实体:                       │ │
│           │    │  - 解析 Shell → Face → Loop → Edge → Vertex            │ │
│           │    │  - 创建 OCC 几何对象 (Geom_Line, Geom_Circle等)         │ │
│           │    │  - 构建 BRep 拓扑结构                                   │ │
│           │    │  - 生成 TopoDS_Solid                                    │ │
│           │    └─────────────────────────────────────────────────────────┘ │
│           │                                                                 │
│           ├──► result = reader.OneShape();  // TopoDS_Compound              │
│           │                                                                 │
│           ├──► _healShape(result, ...)  // 修复几何缺陷                     │
│           │                                                                 │
│           └──► _multiBind(result, ...)  // 绑定到 Gmsh 标签                 │
│                       │                                                     │
│                       ▼                                                     │
│                ┌─────────────────────────────────────────────────────────┐ │
│                │  遍历 3 个 Solid:                                       │ │
│                │  - Solid 1 → tag=1, _solidTag.Bind()                   │ │
│                │  - Solid 2 → tag=2, _solidTag.Bind()                   │ │
│                │  - Solid 3 → tag=3, _solidTag.Bind()                   │ │
│                │  递归绑定所有 Face, Edge, Vertex                        │ │
│                └─────────────────────────────────────────────────────────┘ │
│                       │                                                     │
│                       ▼                                                     │
│   OCC_Internals::synchronize(GModel*)                                       │
│           │                                                                 │
│           ▼                                                                 │
│   创建 GRegion, GFace, GEdge, GVertex 对象                                  │
│           │                                                                 │
│           ▼                                                                 │
│   准备就绪,可进行网格生成                                                   │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 六、总结

| 项目 | hhh.igs 文件内容 |
|------|------------------|
| **生成软件** | Spatial Corp. 3D InterOp |
| **单位** | 毫米 (MM) |
| **精度** | 1.0e-06 |
| **D 段** | 220 行 (110 个实体) |
| **P 段** | 123 条参数记录 |
| **根实体** | 3 个 Type 186 (Manifold Solid B-Rep) |
| **包含几何** | 直线、圆弧、旋转曲面、平面、圆柱面 |

`IGESCAFControl_Reader` 通过解析 IGES 文件的 5 个段，将文本格式的几何数据转换为 OpenCASCADE 的 `TopoDS_Shape` 对象，最终供 Gmsh 进行网格生成。
