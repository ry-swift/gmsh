// ============================================================
// 六面体模型水平切割脚本（分离显示版）
// 功能: 在Z=3500处水平切割第二个六面体（锥台），分成上下两部分并分开显示
// 说明: Volume{1}是底部圆柱(Z:-1000~1000)，Volume{2}是锥台(Z:2000~5000)
// 作者: Claude Code
// 日期: 2025-12-26
// ============================================================

SetFactory("OpenCASCADE");

// 加载原始IGES几何文件
Merge "hhh.igs";

// 获取所有体积（应该有3个：1, 2, 3）
v() = Volume{:};
Printf("切割前找到 %g 个体积", #v());

// ========== 切割Volume{2}（锥台，Z范围2000-5000）==========
// 切割位置：Z = 3500（锥台的中间位置）

// 创建下半部分的切割盒子（Z < 3500）
Box(100) = {-1500, -1500, 1500, 3000, 3000, 2000};  // Z从1500到3500

// 创建上半部分的切割盒子（Z > 3500），并向上移动1500单位以分离显示
Box(101) = {-1500, -1500, 3500 + 1500, 3000, 3000, 2000};   // Z从5000到7000

// 复制Volume{2}用于上半部分
copy() = Translate{0, 0, 1500}{ Duplicata{ Volume{2}; } };
Printf("复制的体积标签: %g", copy(0));

// 步骤1：Volume{2}与下半盒子的交集 -> 下半部分（保持原位）
BooleanIntersection{ Volume{2}; Delete; }{ Volume{100}; Delete; }

// 步骤2：移动后的复制体与移动后的上半盒子的交集 -> 上半部分（已分离）
BooleanIntersection{ Volume{copy(0)}; Delete; }{ Volume{101}; Delete; }

// 同步几何模型
Coherence;

// 统计切割后的体积数量
v2() = Volume{:};
Printf("切割后找到 %g 个体积", #v2());

// ========== 显示设置（提升视觉质感）==========
Mesh.SurfaceFaces = 1;      // 显示表面填充
Mesh.SurfaceEdges = 1;      // 显示边线
Mesh.ColorCarousel = 1;     // 按几何实体着色
Mesh.Light = 1;             // 启用光照
Mesh.LightTwoSide = 1;      // 双面光照
Mesh.AngleSmoothNormals = 30;

// ========== 网格参数 ==========
Mesh.MeshSizeMin = 100;     // 最小网格尺寸
Mesh.MeshSizeMax = 500;     // 最大网格尺寸
Mesh.Algorithm = 6;         // Frontal-Delaunay算法

// ========== 生成网格 ==========
// 生成2D表面网格
Mesh 2;

// ============================================================
// 使用说明:
// 1. 在Gmsh中打开此文件: gmsh cut_hexahedron.geo
// 2. 查看切割结果
// 3. 保存网格: File → Export → hhh_cut.msh
// ============================================================
